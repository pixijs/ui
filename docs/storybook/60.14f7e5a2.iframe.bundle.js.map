{"version":3,"file":"60.14f7e5a2.iframe.bundle.js","mappings":";;;AA4IA;AC3IA;;AAEA;AACA;ACHA;;AAEA;;;;;AAKA;;;;;;ACFA;;AAEA;;;;AAIA;AACA;;;;AAMA;AACA;;;;AAIA;;AAEA;;;;;ACTA;;;AAGA;AACA;;;;;AAKA;AArBA;;;AAGA;AACA;;;AAGA;;;;AARA;;;;AA0BA","sources":["webpack://pixi-ui/./node_modules/@pixi/storybook-renderer/dist/chunk-SHJVHIVM.mjs","webpack://pixi-ui/./node_modules/@storybook/addon-backgrounds/dist/chunk-JUUG26P2.mjs","webpack://pixi-ui/./node_modules/@storybook/client-api/dist/index.mjs","webpack://pixi-ui/./node_modules/@storybook/preview-web/dist/index.mjs","webpack://pixi-ui/./node_modules/@storybook/store/dist/index.mjs"],"sourcesContent":["// src/render.ts\nimport { Application } from \"pixi.js\";\nimport equals from \"deep-equal\";\nimport { dedent } from \"ts-dedent\";\nvar pixiApp;\nvar lastApplicationOptions;\nvar storyState = null;\nvar resizeState = {\n  w: 0,\n  h: 0,\n  canvasWidth: 0,\n  canvasHeight: 0\n};\nfunction resizeDefault(w, h) {\n  return { rendererWidth: w, rendererHeight: h, canvasWidth: w, canvasHeight: h };\n}\nfunction getPixiApplication(applicationOptions) {\n  if (!equals(applicationOptions, lastApplicationOptions)) {\n    if (pixiApp) {\n      pixiApp.destroy(true, {\n        children: true,\n        texture: true,\n        baseTexture: true\n      });\n    }\n    pixiApp = new Application(applicationOptions);\n    pixiApp.view.style.display = \"block\";\n    lastApplicationOptions = applicationOptions;\n  }\n  return pixiApp;\n}\nfunction resizeApplication({\n  containerWidth,\n  containerHeight,\n  app,\n  resizeFn,\n  storyObject,\n  force = false\n}) {\n  const { view, renderer } = app;\n  const newSize = resizeFn(containerWidth, containerHeight);\n  if (force || resizeState.w !== newSize.rendererWidth || resizeState.h !== newSize.rendererHeight || resizeState.canvasWidth !== newSize.canvasWidth || resizeState.canvasHeight !== newSize.canvasHeight) {\n    resizeState.w = newSize.rendererWidth;\n    resizeState.h = newSize.rendererHeight;\n    resizeState.canvasWidth = newSize.canvasWidth;\n    resizeState.canvasHeight = newSize.canvasHeight;\n    view.style.width = `${newSize.canvasWidth}px`;\n    view.style.height = `${newSize.canvasHeight}px`;\n    window.scrollTo(0, 0);\n    renderer.resize(resizeState.w, resizeState.h);\n    storyObject?.resize?.(resizeState.w, resizeState.h);\n  }\n}\nfunction initResize({\n  app,\n  resizeFn,\n  storyObject\n}) {\n  const storyResizeHandler = (e) => resizeApplication({\n    containerWidth: window.innerWidth,\n    containerHeight: window.innerHeight,\n    app,\n    resizeFn,\n    storyObject\n  });\n  window.addEventListener(\"resize\", storyResizeHandler);\n  resizeApplication({\n    containerWidth: window.innerWidth,\n    containerHeight: window.innerHeight,\n    app,\n    resizeFn,\n    storyObject,\n    force: Boolean(storyObject?.resize)\n  });\n  return storyResizeHandler;\n}\nfunction addStory({\n  app,\n  resizeFn,\n  storyObject\n}) {\n  const storyResizeHandler = initResize({\n    app,\n    resizeFn,\n    storyObject\n  });\n  app.stage.addChild(storyObject.view);\n  if (storyObject.update) {\n    app.ticker.add(storyObject.update, storyObject);\n  }\n  return storyResizeHandler;\n}\nfunction removeStory({\n  app,\n  storyObject,\n  storyResizeHandler\n}) {\n  if (storyObject.update) {\n    app.ticker.remove(storyObject.update, storyObject);\n  }\n  app.stage.removeChild(storyObject.view);\n  window.removeEventListener(\"resize\", storyResizeHandler);\n  storyObject.destroy?.();\n}\nfunction renderToDOM({\n  storyContext,\n  storyFn,\n  kind,\n  id,\n  name,\n  showMain,\n  showError,\n  forceRemount\n}, domElement) {\n  const {\n    parameters: { pixi }\n  } = storyContext;\n  const { applicationOptions, resizeFn = resizeDefault } = pixi;\n  const app = getPixiApplication(applicationOptions);\n  if (domElement.firstChild !== app.view || forceRemount) {\n    domElement.innerHTML = \"\";\n    domElement.appendChild(app.view);\n  }\n  if (storyState) {\n    removeStory({\n      app,\n      storyObject: storyState.storyObject,\n      storyResizeHandler: storyState.resizeHandler\n    });\n    storyState = null;\n  }\n  const storyObject = storyFn();\n  showMain();\n  if (!storyObject.view) {\n    showError({\n      title: `Expecting a StoryFnPixiReturnType from the story: \"${name}\" of \"${kind}\".`,\n      description: dedent`\n        Did you forget to return the correct object from the story?\n      `\n    });\n    return () => {\n    };\n  }\n  const storyResizeHandler = addStory({ app, resizeFn, storyObject });\n  storyState = {\n    storyObject,\n    resizeHandler: storyResizeHandler\n  };\n  return () => {\n    removeStory({ app, storyObject, storyResizeHandler });\n  };\n}\n\nexport {\n  renderToDOM\n};\n","var l=\"storybook/background\",y=\"backgrounds\";var u={UPDATE:`${l}/update`};import c from\"global\";import{dedent as g}from\"ts-dedent\";import{logger as m}from\"@storybook/client-logger\";var{document:i,window:p}=c,B=()=>p.matchMedia(\"(prefers-reduced-motion: reduce)\").matches,H=(e,t=[],n)=>{if(e===\"transparent\")return\"transparent\";if(t.find(o=>o.value===e))return e;let r=t.find(o=>o.name===n);if(r)return r.value;if(n){let o=t.map(s=>s.name).join(\", \");m.warn(g`\n        Backgrounds Addon: could not find the default color \"${n}\".\n        These are the available colors for your story based on your configuration:\n        ${o}.\n      `)}return\"transparent\"},L=e=>{(Array.isArray(e)?e:[e]).forEach(f)},f=e=>{let t=i.getElementById(e);t&&t.parentElement.removeChild(t)},h=(e,t)=>{let n=i.getElementById(e);if(n)n.innerHTML!==t&&(n.innerHTML=t);else{let r=i.createElement(\"style\");r.setAttribute(\"id\",e),r.innerHTML=t,i.head.appendChild(r)}},A=(e,t,n)=>{let r=i.getElementById(e);if(r)r.innerHTML!==t&&(r.innerHTML=t);else{let o=i.createElement(\"style\");o.setAttribute(\"id\",e),o.innerHTML=t;let s=`addon-backgrounds-grid${n?`-docs-${n}`:\"\"}`,a=i.getElementById(s);a?a.parentElement.insertBefore(o,a):i.head.appendChild(o)}};export{l as a,y as b,B as c,H as d,L as e,h as f,A as g};\n","import{dedent as G}from\"ts-dedent\";import L from\"global\";import{logger as k}from\"@storybook/client-logger\";import{toId as z,sanitize as N}from\"@storybook/csf\";import{combineParameters as _,composeStepRunners as V,normalizeInputTypes as I}from\"@storybook/store\";import b from\"global\";import{dedent as R}from\"ts-dedent\";import{SynchronousPromise as O}from\"synchronous-promise\";import{toId as w,isExportStory as $,storyNameFromExport as v}from\"@storybook/csf\";import{userOrAutoTitle as M,sortStoriesV6 as C}from\"@storybook/store\";import{logger as D}from\"@storybook/client-logger\";var E=class{constructor(){this.projectAnnotations={loaders:[],decorators:[],parameters:{},argsEnhancers:[],argTypesEnhancers:[],args:{},argTypes:{}},this.entries={},this.csfExports={}}importFn(r){return O.resolve().then(()=>{let e=this.csfExports[r];if(!e)throw new Error(`Unknown path: ${r}`);return e})}getStoryIndex(r){let e=Object.keys(this.csfExports),p=this.projectAnnotations.parameters?.options?.storySort,u=Object.entries(this.entries).map(([s,{type:y,importPath:a,...d}])=>{let i=this.csfExports[a],f=r.processCSFFileWithCache(i,a,i.default.title),n;return y===\"story\"?n=r.storyFromCSFFile({storyId:s,csfFile:f}):n={...d,story:d.name,kind:d.title,componentId:w(d.componentId||d.title),parameters:{fileName:a}},[s,n,f.meta.parameters,this.projectAnnotations.parameters]}),m;try{m=C(u,p,e)}catch(s){throw typeof p==\"function\"?new Error(R`\n          Error sorting stories with sort parameter ${p}:\n\n          > ${s.message}\n          \n          Are you using a V7-style sort function in V6 compatibility mode?\n          \n          More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#v7-style-story-sort\n        `):s}let o=m.reduce((s,y)=>(s[y.id]=this.entries[y.id],s),{});return{v:4,entries:o}}clearFilenameExports(r){!this.csfExports[r]||(Object.entries(this.entries).forEach(([e,{importPath:p}])=>{p===r&&delete this.entries[e]}),this.csfExports[r]={})}addStoriesFromExports(r,e){if(r.match(/\\.mdx$/)&&!r.match(/\\.stories\\.mdx$/)||this.csfExports[r]===e)return;this.clearFilenameExports(r);let{default:p,__namedExportsOrder:l,...u}=e,{id:m,title:o,tags:s=[]}=p||{},y=(b.STORIES||[]).map(n=>({...n,importPathMatcher:new RegExp(n.importPathMatcher)}));if(o=M(r,y,o),!o){D.info(`Unexpected default export without title in '${r}': ${JSON.stringify(e.default)}`);return}this.csfExports[r]={...e,default:{...p,title:o}};let a=u;Array.isArray(l)&&(a={},l.forEach(n=>{let c=u[n];c&&(a[n]=c)}));let d=Object.entries(a).filter(([n])=>$(n,p)),i=b.DOCS_OPTIONS||{},f=i.docsPage===\"automatic\"||i.docsPage&&s.includes(\"docsPage\");if(i.enabled&&d.length&&(s.includes(\"mdx\")||f)){let n=i.defaultName,c=w(m||o,n);this.entries[c]={type:\"docs\",standalone:!1,id:c,title:o,name:n,importPath:r,...m&&{componentId:m},tags:[...s,\"docs\"],storiesImports:[]}}d.forEach(([n,c])=>{let A=v(n),S=c.parameters?.__id||w(m||o,A),x=typeof c!=\"function\"&&c.name||c.storyName||c.story?.name||A;c.parameters?.docsOnly||(this.entries[S]={type:\"story\",id:S,name:x,title:o,importPath:r,...m&&{componentId:m},tags:[...c.tags||s,\"story\"]})})}};var h,Y={addDecorator:\"Instead, use `export const decorators = [];` in your `preview.js`.\",addParameters:\"Instead, use `export const parameters = {};` in your `preview.js`.\",addLoader:\"Instead, use `export const loaders = [];` in your `preview.js`.\",addArgs:\"\",addArgTypes:\"\",addArgsEnhancer:\"\",addArgTypesEnhancer:\"\",addStepRunner:\"\",getGlobalRender:\"\",setGlobalRender:\"\"},g=t=>{if(L.FEATURES?.storyStoreV7)throw new Error(G`You cannot use \\`${t}\\` with the new Story Store.\n\n      ${Y[t]}`);if(!h)throw new Error(`Singleton client API not yet initialized, cannot call \\`${t}\\`.`)},Q=t=>{g(\"addDecorator\"),h.addDecorator(t)},U=t=>{g(\"addParameters\"),h.addParameters(t)},B=t=>{g(\"addLoader\"),h.addLoader(t)},H=t=>{g(\"addArgs\"),h.addArgs(t)},J=t=>{g(\"addArgTypes\"),h.addArgTypes(t)},W=t=>{g(\"addArgsEnhancer\"),h.addArgsEnhancer(t)},q=t=>{g(\"addArgTypesEnhancer\"),h.addArgTypesEnhancer(t)},K=t=>{g(\"addStepRunner\"),h.addStepRunner(t)};var X=t=>{g(\"setGlobalRender\"),h.facade.projectAnnotations.render=t},Z=new Set([\"string\",\"number\",\"boolean\",\"symbol\"]),T=class{constructor({storyStore:r}={}){this.lastFileName=0;this.addDecorator=r=>{this.facade.projectAnnotations.decorators.push(r)};this.addParameters=({globals:r,globalTypes:e,...p})=>{this.facade.projectAnnotations.parameters=_(this.facade.projectAnnotations.parameters,p),r&&(this.facade.projectAnnotations.globals={...this.facade.projectAnnotations.globals,...r}),e&&(this.facade.projectAnnotations.globalTypes={...this.facade.projectAnnotations.globalTypes,...I(e)})};this.addStepRunner=r=>{this.facade.projectAnnotations.runStep=V([this.facade.projectAnnotations.runStep,r].filter(Boolean))};this.addLoader=r=>{this.facade.projectAnnotations.loaders.push(r)};this.addArgs=r=>{this.facade.projectAnnotations.args={...this.facade.projectAnnotations.args,...r}};this.addArgTypes=r=>{this.facade.projectAnnotations.argTypes={...this.facade.projectAnnotations.argTypes,...I(r)}};this.addArgsEnhancer=r=>{this.facade.projectAnnotations.argsEnhancers.push(r)};this.addArgTypesEnhancer=r=>{this.facade.projectAnnotations.argTypesEnhancers.push(r)};this._addedExports={};this.storiesOf=(r,e)=>{if(!r&&typeof r!=\"string\")throw new Error(\"Invalid or missing kind provided for stories, should be a string\");if(e||k.warn(`Missing 'module' parameter for story with a kind of '${r}'. It will break your HMR`),e){let a=Object.getPrototypeOf(e);a.exports&&a.exports.default&&k.error(`Illegal mix of CSF default export and storiesOf calls in a single file: ${a.i}`)}let p=e&&e.id?`${e.id}`:(this.lastFileName++).toString(),l=p,u=1;for(;this._addedExports[l];)u+=1,l=`${p}-${u}`;e&&e.hot&&e.hot.accept&&(e.hot.accept(),e.hot.dispose(()=>{this.facade.clearFilenameExports(l),delete this._addedExports[l],setTimeout(()=>{this._loadAddedExports(),this.onImportFnChanged?.({importFn:this.importFn.bind(this)})},0)}));let m=!1,o={kind:r.toString(),add:()=>o,addDecorator:()=>o,addLoader:()=>o,addParameters:()=>o};Object.keys(this.addons).forEach(a=>{let d=this.addons[a];o[a]=(...i)=>(d.apply(o,i),o)});let s={id:N(r),title:r,decorators:[],loaders:[],parameters:{}};this._addedExports[l]={default:s};let y=0;return o.add=(a,d,i={})=>{if(m=!0,typeof a!=\"string\")throw new Error(`Invalid or missing storyName provided for a \"${r}\" story.`);if(!d||Array.isArray(d)||Z.has(typeof d))throw new Error(`Cannot load story \"${a}\" in \"${r}\" due to invalid format. Storybook expected a function/object but received ${typeof d} instead.`);let{decorators:f,loaders:n,component:c,args:A,argTypes:S,...x}=i,P=i.__id||z(r,a),j=this._addedExports[l];return j[`story${y}`]={name:a,parameters:{fileName:l,__id:P,...x},decorators:f,loaders:n,args:A,argTypes:S,component:c,render:d},y+=1,o},o.addDecorator=a=>{if(m)throw new Error(`You cannot add a decorator after the first story for a kind.\nRead more here: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md#can-no-longer-add-decoratorsparameters-after-stories`);return s.decorators.push(a),o},o.addLoader=a=>{if(m)throw new Error(\"You cannot add a loader after the first story for a kind.\");return s.loaders.push(a),o},o.addParameters=({component:a,args:d,argTypes:i,tags:f,...n})=>{if(m)throw new Error(`You cannot add parameters after the first story for a kind.\nRead more here: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md#can-no-longer-add-decoratorsparameters-after-stories`);return s.parameters=_(s.parameters,n),a&&(s.component=a),d&&(s.args={...s.args,...d}),i&&(s.argTypes={...s.argTypes,...i}),f&&(s.tags=f),o},o};this.raw=()=>this.storyStore.raw();this.facade=new E,this.addons={},this.storyStore=r,h=this}importFn(r){return this.facade.importFn(r)}getStoryIndex(){if(!this.storyStore)throw new Error(\"Cannot get story index before setting storyStore\");return this.facade.getStoryIndex(this.storyStore)}_loadAddedExports(){Object.entries(this._addedExports).forEach(([r,e])=>this.facade.addStoriesFromExports(r,e))}get _storyStore(){return this.storyStore}};export*from\"@storybook/store\";import rr from\"global\";import{parse as tr}from\"qs\";var er=()=>{let{document:t}=rr;return t&&t.location&&t.location.search?tr(t.location.search,{ignoreQueryPrefix:!0}):{}},Sr=t=>er()[t];export{T as ClientApi,J as addArgTypes,q as addArgTypesEnhancer,H as addArgs,W as addArgsEnhancer,Q as addDecorator,B as addLoader,U as addParameters,K as addStepRunner,Sr as getQueryParam,er as getQueryParams,X as setGlobalRender};\n","import{composeConfigs as lt}from\"@storybook/store\";import{dedent as B}from\"ts-dedent\";import b from\"global\";import{SynchronousPromise as q}from\"synchronous-promise\";import{CONFIG_ERROR as pe,FORCE_REMOUNT as me,FORCE_RE_RENDER as Se,GLOBALS_UPDATED as we,RESET_STORY_ARGS as ue,SET_GLOBALS as fe,STORY_ARGS_UPDATED as Ee,STORY_INDEX_INVALIDATED as Re,UPDATE_GLOBALS as ge,UPDATE_STORY_ARGS as be}from\"@storybook/core-events\";import{logger as I}from\"@storybook/client-logger\";import{addons as v}from\"@storybook/addons\";import{StoryStore as Te}from\"@storybook/store\";import H from\"global\";import{logger as le}from\"@storybook/client-logger\";import{STORY_RENDER_PHASE_CHANGED as V,STORY_RENDERED as ce,PLAY_FUNCTION_THREW_EXCEPTION as he}from\"@storybook/core-events\";var w=new Error(\"prepareAborted\");var{AbortController:z}=H;function ye(o){try{let{name:e=\"Error\",message:r=String(o),stack:t}=o;return{name:e,message:r,stack:t}}catch{return{name:\"Error\",message:String(o)}}}var R=class{constructor(e,r,t,n,s,i,d={autoplay:!0},l){this.channel=e;this.store=r;this.renderToScreen=t;this.callbacks=n;this.id=s;this.viewMode=i;this.renderOptions=d;this.type=\"story\";this.notYetRendered=!0;this.disableKeyListeners=!1;this.teardownRender=()=>{};this.torndown=!1;this.abortController=new z,l&&(this.story=l,this.phase=\"preparing\")}async runPhase(e,r,t){this.phase=r,this.channel.emit(V,{newPhase:this.phase,storyId:this.id}),t&&await t(),e.aborted&&(this.phase=\"aborted\",this.channel.emit(V,{newPhase:this.phase,storyId:this.id}))}async prepare(){if(await this.runPhase(this.abortController.signal,\"preparing\",async()=>{this.story=await this.store.loadStory({storyId:this.id})}),this.abortController.signal.aborted)throw this.store.cleanupStory(this.story),w}isEqual(e){return!!(this.id===e.id&&this.story&&this.story===e.story)}isPreparing(){return[\"preparing\"].includes(this.phase)}isPending(){return[\"rendering\",\"playing\"].includes(this.phase)}async renderToElement(e){return this.canvasElement=e,this.render({initial:!0,forceRemount:!0})}storyContext(){if(!this.story)throw new Error(\"Cannot call storyContext before preparing\");return this.store.getStoryContext(this.story)}async render({initial:e=!1,forceRemount:r=!1}={}){let{canvasElement:t}=this;if(!this.story)throw new Error(\"cannot render when not prepared\");if(!t)throw new Error(\"cannot render when canvasElement is unset\");let{id:n,componentId:s,title:i,name:d,tags:l,applyLoaders:a,unboundStoryFn:A,playFunction:p}=this.story;r&&!e&&(this.cancelRender(),this.abortController=new z);let c=this.abortController.signal;try{let h;if(await this.runPhase(c,\"loading\",async()=>{h=await a({...this.storyContext(),viewMode:this.viewMode})}),c.aborted)return;let k={...h,...this.storyContext(),abortSignal:c,canvasElement:t},_={componentId:s,title:i,kind:i,id:n,name:d,story:d,tags:l,...this.callbacks,showError:m=>(this.phase=\"errored\",this.callbacks.showError(m)),showException:m=>(this.phase=\"errored\",this.callbacks.showException(m)),forceRemount:r||this.notYetRendered,storyContext:k,storyFn:()=>A(k),unboundStoryFn:A};if(await this.runPhase(c,\"rendering\",async()=>{let m=await this.renderToScreen(_,t);this.teardownRender=m||(()=>{})}),this.notYetRendered=!1,c.aborted)return;if(this.renderOptions.autoplay&&r&&p&&this.phase!==\"errored\"){this.disableKeyListeners=!0;try{await this.runPhase(c,\"playing\",async()=>{await p(_.storyContext)}),await this.runPhase(c,\"played\")}catch(m){if(le.error(m),await this.runPhase(c,\"errored\",async()=>{this.channel.emit(he,ye(m))}),this.story.parameters.throwPlayFunctionExceptions!==!1)throw m}if(this.disableKeyListeners=!1,c.aborted)return}await this.runPhase(c,\"completed\",async()=>this.channel.emit(ce,n))}catch(h){this.phase=\"errored\",this.callbacks.showException(h)}}async rerender(){return this.render()}async remount(){return this.render({forceRemount:!0})}cancelRender(){this.abortController?.abort()}async teardown(){this.torndown=!0,this.cancelRender(),this.story&&this.store.cleanupStory(this.story);for(let e=0;e<3;e+=1){if(!this.isPending()){await this.teardownRender();return}await new Promise(r=>setTimeout(r,0))}H.window.location.reload(),await new Promise(()=>{})}};var{fetch:Pe}=b,Fe=\"./index.json\",T=class{constructor(e=v.getChannel()){this.channel=e;this.storyRenders=[];b.FEATURES?.storyStoreV7&&v.hasServerChannel()&&(this.serverChannel=v.getServerChannel()),this.storyStore=new Te}initialize({getStoryIndex:e,importFn:r,getProjectAnnotations:t}){return this.getStoryIndex=e,this.importFn=r,this.setupListeners(),this.getProjectAnnotationsOrRenderError(t).then(n=>this.initializeWithProjectAnnotations(n))}setupListeners(){this.serverChannel?.on(Re,this.onStoryIndexChanged.bind(this)),this.channel.on(ge,this.onUpdateGlobals.bind(this)),this.channel.on(be,this.onUpdateArgs.bind(this)),this.channel.on(ue,this.onResetArgs.bind(this)),this.channel.on(Se,this.onForceReRender.bind(this)),this.channel.on(me,this.onForceRemount.bind(this))}getProjectAnnotationsOrRenderError(e){return q.resolve().then(e).then(r=>{if(this.renderToDOM=r.renderToDOM,!this.renderToDOM)throw new Error(B`\n            Expected your framework's preset to export a \\`renderToDOM\\` field.\n\n            Perhaps it needs to be upgraded for Storybook 6.4?\n\n            More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#mainjs-framework-field\n          `);return r}).catch(r=>{throw this.renderPreviewEntryError(\"Error reading preview.js:\",r),r})}initializeWithProjectAnnotations(e){this.storyStore.setProjectAnnotations(e),this.setInitialGlobals();let r;if(b.FEATURES?.storyStoreV7)r=this.getStoryIndexFromServer();else{if(!this.getStoryIndex)throw new Error(\"No `getStoryIndex` passed defined in v6 mode\");r=q.resolve().then(this.getStoryIndex)}return r.then(t=>this.initializeWithStoryIndex(t)).catch(t=>{throw this.renderPreviewEntryError(\"Error loading story index:\",t),t})}async setInitialGlobals(){this.emitGlobals()}emitGlobals(){if(!this.storyStore.globals||!this.storyStore.projectAnnotations)throw new Error(\"Cannot emit before initialization\");this.channel.emit(fe,{globals:this.storyStore.globals.get()||{},globalTypes:this.storyStore.projectAnnotations.globalTypes||{}})}async getStoryIndexFromServer(){let e=await Pe(Fe);if(e.status===200)return e.json();throw new Error(await e.text())}initializeWithStoryIndex(e){if(!this.importFn)throw new Error(\"Cannot call initializeWithStoryIndex before initialization\");return this.storyStore.initialize({storyIndex:e,importFn:this.importFn,cache:!b.FEATURES?.storyStoreV7})}async onGetProjectAnnotationsChanged({getProjectAnnotations:e}){delete this.previewEntryError;let r=await this.getProjectAnnotationsOrRenderError(e);if(!this.storyStore.projectAnnotations){await this.initializeWithProjectAnnotations(r);return}await this.storyStore.setProjectAnnotations(r),this.emitGlobals()}async onStoryIndexChanged(){if(delete this.previewEntryError,!!this.storyStore.projectAnnotations)try{let e=await this.getStoryIndexFromServer();this.storyStore.storyIndex||await this.initializeWithStoryIndex(e),await this.onStoriesChanged({storyIndex:e})}catch(e){throw this.renderPreviewEntryError(\"Error loading story index:\",e),e}}async onStoriesChanged({importFn:e,storyIndex:r}){await this.storyStore.onStoriesChanged({importFn:e,storyIndex:r})}async onUpdateGlobals({globals:e}){if(!this.storyStore.globals)throw new Error(\"Cannot call onUpdateGlobals before initialization\");this.storyStore.globals.update(e),await Promise.all(this.storyRenders.map(r=>r.rerender())),this.channel.emit(we,{globals:this.storyStore.globals.get(),initialGlobals:this.storyStore.globals.initialGlobals})}async onUpdateArgs({storyId:e,updatedArgs:r}){this.storyStore.args.update(e,r),await Promise.all(this.storyRenders.filter(t=>t.id===e).map(t=>t.rerender())),this.channel.emit(Ee,{storyId:e,args:this.storyStore.args.get(e)})}async onResetArgs({storyId:e,argNames:r}){let n=this.storyRenders.find(d=>d.id===e)?.story||await this.storyStore.loadStory({storyId:e}),i=(r||[...new Set([...Object.keys(n.initialArgs),...Object.keys(this.storyStore.args.get(e))])]).reduce((d,l)=>(d[l]=n.initialArgs[l],d),{});await this.onUpdateArgs({storyId:e,updatedArgs:i})}async onForceReRender(){await Promise.all(this.storyRenders.map(e=>e.rerender()))}async onForceRemount({storyId:e}){await Promise.all(this.storyRenders.filter(r=>r.id===e).map(r=>r.remount()))}renderStoryToElement(e,r,t){if(!this.renderToDOM)throw new Error(\"Cannot call renderStoryToElement before initialization\");let n=new R(this.channel,this.storyStore,this.renderToDOM,this.inlineStoryCallbacks(e.id),e.id,\"docs\",t,e);return n.renderToElement(r),this.storyRenders.push(n),async()=>{await this.teardownRender(n)}}async teardownRender(e,{viewModeChanged:r}={}){this.storyRenders=this.storyRenders.filter(t=>t!==e),await e?.teardown?.({viewModeChanged:r})}async extract(e){if(this.previewEntryError)throw this.previewEntryError;if(!this.storyStore.projectAnnotations)throw new Error(B`Failed to initialize Storybook.\n\n      Do you have an error in your \\`preview.js\\`? Check your Storybook's browser console for errors.`);return b.FEATURES?.storyStoreV7&&await this.storyStore.cacheAllCSFFiles(),this.storyStore.extract(e)}inlineStoryCallbacks(e){return{showMain:()=>{},showError:r=>I.error(`Error rendering docs story (${e})`,r),showException:r=>I.error(`Error rendering docs story (${e})`,r)}}renderPreviewEntryError(e,r){this.previewEntryError=r,I.error(e),I.error(r),this.channel.emit(pe,r)}};import{dedent as W}from\"ts-dedent\";import C from\"global\";import{CURRENT_STORY_WAS_SET as oe,PRELOAD_ENTRIES as Ve,PREVIEW_KEYDOWN as ze,SET_CURRENT_STORY as He,SET_INDEX as ne,STORY_ARGS_UPDATED as Be,STORY_CHANGED as qe,STORY_ERRORED as Ke,STORY_MISSING as se,STORY_PREPARED as Qe,STORY_RENDER_PHASE_CHANGED as ie,STORY_SPECIFIED as Xe,STORY_THREW_EXCEPTION as Ze,STORY_UNCHANGED as Je,UPDATE_QUERY_PARAMS as er}from\"@storybook/core-events\";import{logger as g}from\"@storybook/client-logger\";import Me from\"global\";import j from\"qs\";import xe from\"qs\";import{dedent as Ce}from\"ts-dedent\";import{once as Ae}from\"@storybook/client-logger\";import ke from\"lodash/isPlainObject\";var K=/^[a-zA-Z0-9 _-]*$/,Q=/^-?[0-9]+(\\.[0-9]+)?$/,_e=/^#([a-f0-9]{3,4}|[a-f0-9]{6}|[a-f0-9]{8})$/i,X=/^(rgba?|hsla?)\\(([0-9]{1,3}),\\s?([0-9]{1,3})%?,\\s?([0-9]{1,3})%?,?\\s?([0-9](\\.[0-9]{1,2})?)?\\)$/i,O=(o=\"\",e)=>o===null||o===\"\"||!K.test(o)?!1:e==null||e instanceof Date||typeof e==\"number\"||typeof e==\"boolean\"?!0:typeof e==\"string\"?K.test(e)||Q.test(e)||_e.test(e)||X.test(e):Array.isArray(e)?e.every(r=>O(o,r)):ke(e)?Object.entries(e).every(([r,t])=>O(r,t)):!1,Ie={delimiter:\";\",allowDots:!0,allowSparse:!0,decoder(o,e,r,t){if(t===\"value\"&&o.startsWith(\"!\")){if(o===\"!undefined\")return;if(o===\"!null\")return null;if(o.startsWith(\"!date(\")&&o.endsWith(\")\"))return new Date(o.slice(6,-1));if(o.startsWith(\"!hex(\")&&o.endsWith(\")\"))return`#${o.slice(5,-1)}`;let n=o.slice(1).match(X);if(n)return o.startsWith(\"!rgba\")?`${n[1]}(${n[2]}, ${n[3]}, ${n[4]}, ${n[5]})`:o.startsWith(\"!hsla\")?`${n[1]}(${n[2]}, ${n[3]}%, ${n[4]}%, ${n[5]})`:o.startsWith(\"!rgb\")?`${n[1]}(${n[2]}, ${n[3]}, ${n[4]})`:`${n[1]}(${n[2]}, ${n[3]}%, ${n[4]}%)`}return t===\"value\"&&Q.test(o)?Number(o):e(o,e,r)}},L=o=>{let e=o.split(\";\").map(r=>r.replace(\"=\",\"~\").replace(\":\",\"=\"));return Object.entries(xe.parse(e.join(\";\"),Ie)).reduce((r,[t,n])=>O(t,n)?Object.assign(r,{[t]:n}):(Ae.warn(Ce`\n      Omitted potentially unsafe URL args.\n\n      More info: https://storybook.js.org/docs/react/writing-stories/args#setting-args-through-the-url\n    `),r),{})};var{history:Z,document:u}=Me;function De(o){let e=(o||\"\").match(/^\\/story\\/(.+)/);if(!e)throw new Error(`Invalid path '${o}',  must start with '/story/'`);return e[1]}var J=({selection:o,extraParams:e})=>{let{search:r=\"\"}=u.location,{path:t,selectedKind:n,selectedStory:s,...i}=j.parse(r,{ignoreQueryPrefix:!0});return j.stringify({...i,...e,...o&&{id:o.storyId,viewMode:o.viewMode}},{encode:!1,addQueryPrefix:!0})},ve=o=>{if(!o)return;let e=J({selection:o}),{hash:r=\"\"}=u.location;u.title=o.storyId,Z.replaceState({},\"\",`${u.location.pathname}${e}${r}`)},Oe=o=>o!=null&&typeof o==\"object\"&&Array.isArray(o)===!1,P=o=>{if(o!==void 0){if(typeof o==\"string\")return o;if(Array.isArray(o))return P(o[0]);if(Oe(o))return P(Object.values(o).filter(Boolean))}},Le=()=>{let o=j.parse(u.location.search,{ignoreQueryPrefix:!0}),e=typeof o.args==\"string\"?L(o.args):void 0,r=typeof o.globals==\"string\"?L(o.globals):void 0,t=P(o.viewMode);(typeof t!=\"string\"||!t.match(/docs|story/))&&(t=\"story\");let n=P(o.path),s=n?De(n):P(o.id);return s?{storySpecifier:s,args:e,globals:r,viewMode:t}:null},M=class{constructor(){this.selectionSpecifier=Le()}setSelection(e){this.selection=e,ve(this.selection)}setQueryParams(e){let r=J({extraParams:e}),{hash:t=\"\"}=u.location;Z.replaceState({},\"\",`${u.location.pathname}${r}${t}`)}};import je from\"global\";import{logger as Ne}from\"@storybook/client-logger\";import Ge from\"ansi-to-html\";import{dedent as We}from\"ts-dedent\";import $e from\"qs\";var{document:y}=je,ee=100,N={centered:\"sb-main-centered\",fullscreen:\"sb-main-fullscreen\",padded:\"sb-main-padded\"},te=(s=>(s.MAIN=\"MAIN\",s.NOPREVIEW=\"NOPREVIEW\",s.PREPARING_STORY=\"PREPARING_STORY\",s.PREPARING_DOCS=\"PREPARING_DOCS\",s.ERROR=\"ERROR\",s))(te||{}),G={PREPARING_STORY:\"sb-show-preparing-story\",PREPARING_DOCS:\"sb-show-preparing-docs\",MAIN:\"sb-show-main\",NOPREVIEW:\"sb-show-nopreview\",ERROR:\"sb-show-errordisplay\"},re=new Ge({escapeXML:!0}),D=class{constructor(){this.testing=!1;let{__SPECIAL_TEST_PARAMETER__:e}=$e.parse(y.location.search,{ignoreQueryPrefix:!0});switch(e){case\"preparing-story\":{this.showPreparingStory(),this.testing=!0;break}case\"preparing-docs\":{this.showPreparingDocs(),this.testing=!0;break}default:}}prepareForStory(e){return this.showStory(),this.applyLayout(e.parameters.layout),y.documentElement.scrollTop=0,y.documentElement.scrollLeft=0,this.storyRoot()}storyRoot(){return y.getElementById(\"storybook-root\")}prepareForDocs(){return this.showMain(),this.showDocs(),this.applyLayout(\"fullscreen\"),this.docsRoot()}docsRoot(){return y.getElementById(\"storybook-docs\")}applyLayout(e=\"padded\"){if(e===\"none\"){y.body.classList.remove(this.currentLayoutClass),this.currentLayoutClass=null;return}this.checkIfLayoutExists(e);let r=N[e];y.body.classList.remove(this.currentLayoutClass),y.body.classList.add(r),this.currentLayoutClass=r}checkIfLayoutExists(e){N[e]||Ne.warn(We`The desired layout: ${e} is not a valid option.\n         The possible options are: ${Object.keys(N).join(\", \")}, none.`)}showMode(e){clearTimeout(this.preparingTimeout),Object.keys(te).forEach(r=>{r===e?y.body.classList.add(G[r]):y.body.classList.remove(G[r])})}showErrorDisplay({message:e=\"\",stack:r=\"\"}){let t=e,n=r,s=e.split(`\n`);s.length>1&&([t]=s,n=s.slice(1).join(`\n`)),y.getElementById(\"error-message\").innerHTML=re.toHtml(t),y.getElementById(\"error-stack\").innerHTML=re.toHtml(n),this.showMode(\"ERROR\")}showNoPreview(){this.testing||(this.showMode(\"NOPREVIEW\"),this.storyRoot()?.setAttribute(\"hidden\",\"true\"),this.docsRoot()?.setAttribute(\"hidden\",\"true\"))}showPreparingStory({immediate:e=!1}={}){clearTimeout(this.preparingTimeout),e?this.showMode(\"PREPARING_STORY\"):this.preparingTimeout=setTimeout(()=>this.showMode(\"PREPARING_STORY\"),ee)}showPreparingDocs(){clearTimeout(this.preparingTimeout),this.preparingTimeout=setTimeout(()=>this.showMode(\"PREPARING_DOCS\"),ee)}showMain(){this.showMode(\"MAIN\")}showDocs(){this.storyRoot().setAttribute(\"hidden\",\"true\"),this.docsRoot().removeAttribute(\"hidden\")}showStory(){this.docsRoot().setAttribute(\"hidden\",\"true\"),this.storyRoot().removeAttribute(\"hidden\")}showStoryDuringRender(){y.body.classList.add(G.MAIN)}};import{DOCS_RENDERED as Ue}from\"@storybook/core-events\";var f=class{constructor(e,r,t,n,s=!0){this.channel=e;this.store=r;this.renderStoryToElement=t;this.storyIdByName=e=>{let r=this.nameToStoryId.get(e);if(r)return r;throw new Error(`No story found with that name: ${e}`)};this.componentStories=()=>this.componentStoriesValue;this.storyById=e=>{if(!e){if(!this.primaryStory)throw new Error(\"No primary story defined for docs entry. Did you forget to use `<Meta>`?\");return this.primaryStory}let r=this.storyIdToCSFFile.get(e);if(!r)throw new Error(`Called \\`storyById\\` for story that was never loaded: ${e}`);return this.store.storyFromCSFFile({storyId:e,csfFile:r})};this.getStoryContext=e=>({...this.store.getStoryContext(e),viewMode:\"docs\"});this.loadStory=e=>this.store.loadStory({storyId:e});this.storyIdToCSFFile=new Map,this.exportToStoryId=new Map,this.nameToStoryId=new Map,this.componentStoriesValue=[],n.forEach((i,d)=>{this.referenceCSFFile(i,s||d===0)})}referenceCSFFile(e,r){Object.values(e.stories).forEach(t=>{if(this.storyIdToCSFFile.set(t.id,e),this.exportToStoryId.set(t.moduleExport,t.id),r){this.nameToStoryId.set(t.name,t.id);let n=this.storyById(t.id);this.componentStoriesValue.push(n),this.primaryStory||(this.primaryStory=n)}})}setMeta(e){}storyIdByModuleExport(e,r){let t=this.exportToStoryId.get(e);if(t)return t;throw new Error(`No story found with that export: ${e}`)}};var F=class{constructor(e,r,t){this.channel=e;this.store=r;this.entry=t;this.type=\"docs\";this.torndown=!1;this.disableKeyListeners=!1;this.preparing=!1;this.id=t.id}isPreparing(){return this.preparing}async prepare(){this.preparing=!0;let{entryExports:e,csfFiles:r=[]}=await this.store.loadEntry(this.id);if(this.torndown)throw w;let{importPath:t,title:n}=this.entry,s=this.store.processCSFFileWithCache(e,t,n),i=Object.keys(s.stories)[0];this.story=this.store.storyFromCSFFile({storyId:i,csfFile:s}),this.csfFiles=[s,...r],this.preparing=!1}isEqual(e){return!!(this.id===e.id&&this.story&&this.story===e.story)}async renderToElement(e,r){if(!this.story||!this.csfFiles)throw new Error(\"Cannot render docs before preparing\");let t=new f(this.channel,this.store,r,this.csfFiles,!0),{docs:n}=this.story.parameters||{};if(!n)throw new Error(\"Cannot render a story in viewMode=docs if `@storybook/addon-docs` is not installed\");let s=await n.renderer(),{render:i}=s,d=async()=>{await new Promise(l=>i(t,n,e,l)),this.channel.emit(Ue,this.id)};return this.rerender=async()=>d(),this.teardownRender=async({viewModeChanged:l})=>{!l||!e||s.unmount(e)},d()}async teardown({viewModeChanged:e}={}){this.teardownRender?.({viewModeChanged:e}),this.torndown=!0}};import{DOCS_RENDERED as Ye}from\"@storybook/core-events\";var x=class{constructor(e,r,t){this.channel=e;this.store=r;this.entry=t;this.type=\"docs\";this.torndown=!1;this.disableKeyListeners=!1;this.preparing=!1;this.id=t.id}isPreparing(){return this.preparing}async prepare(){this.preparing=!0;let{entryExports:e,csfFiles:r=[]}=await this.store.loadEntry(this.id);if(this.torndown)throw w;this.csfFiles=r,this.exports=e,this.preparing=!1}isEqual(e){return!!(this.id===e.id&&this.exports&&this.exports===e.exports)}async renderToElement(e,r){if(!this.exports||!this.csfFiles||!this.store.projectAnnotations)throw new Error(\"Cannot render docs before preparing\");let t=new f(this.channel,this.store,r,this.csfFiles,!1),{docs:n}=this.store.projectAnnotations.parameters||{};if(!n)throw new Error(\"Cannot render a story in viewMode=docs if `@storybook/addon-docs` is not installed\");let s={...n,page:this.exports.default},i=await n.renderer(),{render:d}=i,l=async()=>{await new Promise(a=>d(t,s,e,a)),this.channel.emit(Ye,this.id)};return this.rerender=async()=>l(),this.teardownRender=async({viewModeChanged:a}={})=>{!a||!e||(i.unmount(e),this.torndown=!0)},l()}async teardown({viewModeChanged:e}={}){this.teardownRender?.({viewModeChanged:e}),this.torndown=!0}};var{window:rr}=C;function tr(o){let e=o.target;return/input|textarea/i.test(e.tagName)||e.getAttribute(\"contenteditable\")!==null}function $(o){return o.type===\"story\"}var U=class extends T{constructor(){super();this.view=new D,this.urlStore=new M}setupListeners(){super.setupListeners(),rr.onkeydown=this.onKeydown.bind(this),this.channel.on(He,this.onSetCurrentStory.bind(this)),this.channel.on(er,this.onUpdateQueryParams.bind(this)),this.channel.on(Ve,this.onPreloadStories.bind(this))}initializeWithProjectAnnotations(r){return super.initializeWithProjectAnnotations(r).then(()=>this.setInitialGlobals())}async setInitialGlobals(){if(!this.storyStore.globals)throw new Error(\"Cannot call setInitialGlobals before initialization\");let{globals:r}=this.urlStore.selectionSpecifier||{};r&&this.storyStore.globals.updateFromPersisted(r),this.emitGlobals()}initializeWithStoryIndex(r){return super.initializeWithStoryIndex(r).then(()=>(C.FEATURES?.storyStoreV7||this.channel.emit(ne,this.storyStore.getSetIndexPayload()),this.selectSpecifiedStory()))}async selectSpecifiedStory(){if(!this.storyStore.storyIndex)throw new Error(\"Cannot call selectSpecifiedStory before initialization\");if(!this.urlStore.selectionSpecifier){this.renderMissingStory();return}let{storySpecifier:r,args:t}=this.urlStore.selectionSpecifier,n=this.storyStore.storyIndex.entryFromSpecifier(r);if(!n){r===\"*\"?this.renderStoryLoadingException(r,new Error(W`\n            Couldn't find any stories in your Storybook.\n            - Please check your stories field of your main.js config.\n            - Also check the browser console and terminal for error messages.\n          `)):this.renderStoryLoadingException(r,new Error(W`\n            Couldn't find story matching '${r}'.\n            - Are you sure a story with that id exists?\n            - Please check your stories field of your main.js config.\n            - Also check the browser console and terminal for error messages.\n          `));return}let{id:s,type:i}=n;this.urlStore.setSelection({storyId:s,viewMode:i}),this.channel.emit(Xe,this.urlStore.selection),this.channel.emit(oe,this.urlStore.selection),await this.renderSelection({persistedArgs:t})}async onGetProjectAnnotationsChanged({getProjectAnnotations:r}){await super.onGetProjectAnnotationsChanged({getProjectAnnotations:r}),this.urlStore.selection&&this.renderSelection()}async onStoriesChanged({importFn:r,storyIndex:t}){await super.onStoriesChanged({importFn:r,storyIndex:t}),C.FEATURES?.storyStoreV7||this.channel.emit(ne,await this.storyStore.getSetIndexPayload()),this.urlStore.selection?await this.renderSelection():await this.selectSpecifiedStory()}onKeydown(r){if(!this.storyRenders.find(t=>t.disableKeyListeners)&&!tr(r)){let{altKey:t,ctrlKey:n,metaKey:s,shiftKey:i,key:d,code:l,keyCode:a}=r;this.channel.emit(ze,{event:{altKey:t,ctrlKey:n,metaKey:s,shiftKey:i,key:d,code:l,keyCode:a}})}}async onSetCurrentStory(r){await this.storyStore.initializationPromise,this.urlStore.setSelection({viewMode:\"story\",...r}),this.channel.emit(oe,this.urlStore.selection),this.renderSelection()}onUpdateQueryParams(r){this.urlStore.setQueryParams(r)}async onUpdateGlobals({globals:r}){super.onUpdateGlobals({globals:r}),(this.currentRender instanceof x||this.currentRender instanceof F)&&await this.currentRender.rerender?.()}async onUpdateArgs({storyId:r,updatedArgs:t}){super.onUpdateArgs({storyId:r,updatedArgs:t})}async onPreloadStories({ids:r}){await Promise.allSettled(r.map(t=>this.storyStore.loadEntry(t)))}async renderSelection({persistedArgs:r}={}){let{renderToDOM:t}=this;if(!t)throw new Error(\"Cannot call renderSelection before initialization\");let{selection:n}=this.urlStore;if(!n)throw new Error(\"Cannot call renderSelection as no selection was made\");let{storyId:s}=n,i;try{i=await this.storyStore.storyIdToEntry(s)}catch(h){this.currentRender&&await this.teardownRender(this.currentRender),this.renderStoryLoadingException(s,h);return}let d=this.currentSelection?.storyId!==s,l=this.currentRender?.type!==i.type;i.type===\"story\"?this.view.showPreparingStory({immediate:l}):this.view.showPreparingDocs(),this.currentRender?.isPreparing()&&await this.teardownRender(this.currentRender);let a;i.type===\"story\"?a=new R(this.channel,this.storyStore,(...h)=>(this.view.showStoryDuringRender(),t(...h)),this.mainStoryCallbacks(s),s,\"story\"):i.standalone?a=new x(this.channel,this.storyStore,i):a=new F(this.channel,this.storyStore,i);let A=this.currentSelection;this.currentSelection=n;let p=this.currentRender;this.currentRender=a;try{await a.prepare()}catch(h){h!==w&&(p&&await this.teardownRender(p),this.renderStoryLoadingException(s,h));return}let c=!d&&p&&!a.isEqual(p);if(r&&$(a)){if(!a.story)throw new Error(\"Render has not been prepared!\");this.storyStore.args.updateFromPersisted(a.story,r)}if(p&&!p.torndown&&!d&&!c&&!l){this.currentRender=p,this.channel.emit(Je,s),this.view.showMain();return}if(p&&await this.teardownRender(p,{viewModeChanged:l}),A&&(d||l)&&this.channel.emit(qe,s),$(a)){if(!a.story)throw new Error(\"Render has not been prepared!\");let{parameters:h,initialArgs:k,argTypes:_,args:m}=this.storyStore.getStoryContext(a.story);C.FEATURES?.storyStoreV7&&this.channel.emit(Qe,{id:s,parameters:h,initialArgs:k,argTypes:_,args:m}),(c||r)&&this.channel.emit(Be,{storyId:s,args:m})}if($(a)){if(!a.story)throw new Error(\"Render has not been prepared!\");this.storyRenders.push(a),this.currentRender.renderToElement(this.view.prepareForStory(a.story))}else this.currentRender.renderToElement(this.view.prepareForDocs(),this.renderStoryToElement.bind(this))}async teardownRender(r,{viewModeChanged:t=!1}={}){this.storyRenders=this.storyRenders.filter(n=>n!==r),await r?.teardown?.({viewModeChanged:t})}async extract(r){if(this.previewEntryError)throw this.previewEntryError;if(!this.storyStore.projectAnnotations)throw new Error(W`Failed to initialize Storybook.\n\n      Do you have an error in your \\`preview.js\\`? Check your Storybook's browser console for errors.`);return C.FEATURES?.storyStoreV7&&await this.storyStore.cacheAllCSFFiles(),this.storyStore.extract(r)}mainStoryCallbacks(r){return{showMain:()=>this.view.showMain(),showError:t=>this.renderError(r,t),showException:t=>this.renderException(r,t)}}inlineStoryCallbacks(r){return{showMain:()=>{},showError:t=>g.error(`Error rendering docs story (${r})`,t),showException:t=>g.error(`Error rendering docs story (${r})`,t)}}renderPreviewEntryError(r,t){super.renderPreviewEntryError(r,t),this.view.showErrorDisplay(t)}renderMissingStory(){this.view.showNoPreview(),this.channel.emit(se)}renderStoryLoadingException(r,t){g.error(t),this.view.showErrorDisplay(t),this.channel.emit(se,r)}renderException(r,t){let{name:n=\"Error\",message:s=String(t),stack:i}=t;this.channel.emit(Ze,{name:n,message:s,stack:i}),this.channel.emit(ie,{newPhase:\"errored\",storyId:r}),t.message?.startsWith(\"ignoredException\")||(this.view.showErrorDisplay(t),g.error(`Error rendering story '${r}':`),g.error(t))}renderError(r,{title:t,description:n}){g.error(`Error rendering story ${t}: ${n}`),this.channel.emit(Ke,{title:t,description:n}),this.channel.emit(ie,{newPhase:\"errored\",storyId:r}),this.view.showErrorDisplay({message:t,stack:n})}};import or from\"global\";var{document:E}=or,nr=[\"application/javascript\",\"application/ecmascript\",\"application/x-ecmascript\",\"application/x-javascript\",\"text/ecmascript\",\"text/javascript\",\"text/javascript1.0\",\"text/javascript1.1\",\"text/javascript1.2\",\"text/javascript1.3\",\"text/javascript1.4\",\"text/javascript1.5\",\"text/jscript\",\"text/livescript\",\"text/x-ecmascript\",\"text/x-javascript\",\"module\"],sr=\"script\",ae=\"scripts-root\";function Y(){let o=E.createEvent(\"Event\");o.initEvent(\"DOMContentLoaded\",!0,!0),E.dispatchEvent(o)}function ir(o,e,r){let t=E.createElement(\"script\");t.type=o.type===\"module\"?\"module\":\"text/javascript\",o.src?(t.onload=e,t.onerror=e,t.src=o.src):t.textContent=o.innerText,r?r.appendChild(t):E.head.appendChild(t),o.parentNode.removeChild(o),o.src||e()}function de(o,e,r=0){o[r](()=>{r++,r===o.length?e():de(o,e,r)})}function ar(o){let e=E.getElementById(ae);e?e.innerHTML=\"\":(e=E.createElement(\"div\"),e.id=ae,E.body.appendChild(e));let r=Array.from(o.querySelectorAll(sr));if(r.length){let t=[];r.forEach(n=>{let s=n.getAttribute(\"type\");(!s||nr.includes(s))&&t.push(i=>ir(n,i,e))}),t.length&&de(t,Y,void 0)}else Y()}export{f as DocsContext,T as Preview,U as PreviewWeb,lt as composeConfigs,Y as simulateDOMContentLoaded,ar as simulatePageLoad};\n","import wr from\"memoizerific\";import Fe from\"lodash/mapValues\";import xr from\"lodash/pick\";import{SynchronousPromise as tr}from\"synchronous-promise\";import{HooksContext as he}from\"@storybook/addons\";import{dedent as Rr}from\"ts-dedent\";import Gr from\"memoizerific\";var Dr=Gr(1)(e=>Object.values(e).reduce((r,t)=>(r[t.importPath]=r[t.importPath]||t,r),{})),z=class{constructor({entries:r}={v:4,entries:{}}){this.entries=r}entryFromSpecifier(r){let t=Object.values(this.entries);if(r===\"*\")return t[0];if(typeof r==\"string\")return this.entries[r]?this.entries[r]:t.find(s=>s.id.startsWith(r));let{name:o,title:n}=r;return t.find(s=>s.name===o&&s.title===n)}storyIdToEntry(r){let t=this.entries[r];if(!t)throw new Error(Rr`Couldn't find story matching '${r}' after HMR.\n      - Did you remove it from your CSF file?\n      - Are you sure a story with that id exists?\n      - Please check your entries field of your main.js config.\n      - Also check the browser console and terminal for error messages.`);return t}importPathToEntry(r){return Dr(this.entries)[r]}};import{dequal as Mr}from\"dequal\";import{once as J}from\"@storybook/client-logger\";import N from\"lodash/isPlainObject\";import{dedent as pr}from\"ts-dedent\";var x=Symbol(\"incompatible\"),Y=(e,r)=>{let t=r.type;if(e==null||!t||r.mapping)return e;switch(t.name){case\"string\":return String(e);case\"enum\":return e;case\"number\":return Number(e);case\"boolean\":return e===\"true\";case\"array\":return!t.value||!Array.isArray(e)?x:e.reduce((o,n,s)=>{let i=Y(n,{type:t.value});return i!==x&&(o[s]=i),o},new Array(e.length));case\"object\":return typeof e==\"string\"||typeof e==\"number\"?e:!t.value||typeof e!=\"object\"?x:Object.entries(e).reduce((o,[n,s])=>{let i=Y(s,{type:t.value[n]});return i===x?o:Object.assign(o,{[n]:i})},{});default:return x}},cr=(e,r)=>Object.entries(e).reduce((t,[o,n])=>{if(!r[o])return t;let s=Y(n,r[o]);return s===x?t:Object.assign(t,{[o]:s})},{}),B=(e,r)=>Array.isArray(e)&&Array.isArray(r)?r.reduce((t,o,n)=>(t[n]=B(e[n],r[n]),t),[...e]).filter(t=>t!==void 0):!N(e)||!N(r)?r:Object.keys({...e,...r}).reduce((t,o)=>{if(o in r){let n=B(e[o],r[o]);n!==void 0&&(t[o]=n)}else t[o]=e[o];return t},{}),dr=(e,r)=>Object.entries(r).reduce((t,[o,{options:n}])=>{function s(){return o in e&&(t[o]=e[o]),t}if(!n)return s();if(!Array.isArray(n))return J.error(pr`\n        Invalid argType: '${o}.options' should be an array.\n\n        More info: https://storybook.js.org/docs/react/api/argtypes\n      `),s();if(n.some(m=>m&&[\"object\",\"function\"].includes(typeof m)))return J.error(pr`\n        Invalid argType: '${o}.options' should only contain primitives. Use a 'mapping' for complex values.\n\n        More info: https://storybook.js.org/docs/react/writing-stories/args#mapping-to-complex-arg-values\n      `),s();let i=Array.isArray(e[o]),a=i&&e[o].findIndex(m=>!n.includes(m)),l=i&&a===-1;if(e[o]===void 0||n.includes(e[o])||l)return s();let y=i?`${o}[${a}]`:o,d=n.map(m=>typeof m==\"string\"?`'${m}'`:String(m)).join(\", \");return J.warn(`Received illegal value for '${y}'. Supported options: ${d}`),t},{}),b=Symbol(\"Deeply equal\"),_=(e,r)=>{if(typeof e!=typeof r)return r;if(Mr(e,r))return b;if(Array.isArray(e)&&Array.isArray(r)){let t=r.reduce((o,n,s)=>{let i=_(e[s],n);return i!==b&&(o[s]=i),o},new Array(r.length));return r.length>=e.length?t:t.concat(new Array(e.length-r.length).fill(void 0))}return N(e)&&N(r)?Object.keys({...e,...r}).reduce((t,o)=>{let n=_(e?.[o],r?.[o]);return n===b?t:Object.assign(t,{[o]:n})},{}):r},R=\"\";function q({args:e,argTypes:r}){let t={};return Object.entries(e).forEach(([o,n])=>{let{target:s=R}=r[o]||{};t[s]=t[s]||{},t[s][o]=n}),t}function ve(e){return q(e)[R]}function $r(e){return Object.keys(e).forEach(r=>e[r]===void 0&&delete e[r]),e}var G=class{constructor(){this.initialArgsByStoryId={};this.argsByStoryId={}}get(r){if(!(r in this.argsByStoryId))throw new Error(`No args known for ${r} -- has it been rendered yet?`);return this.argsByStoryId[r]}setInitial(r){if(!this.initialArgsByStoryId[r.id])this.initialArgsByStoryId[r.id]=r.initialArgs,this.argsByStoryId[r.id]=r.initialArgs;else if(this.initialArgsByStoryId[r.id]!==r.initialArgs){let t=_(this.initialArgsByStoryId[r.id],this.argsByStoryId[r.id]);this.initialArgsByStoryId[r.id]=r.initialArgs,this.argsByStoryId[r.id]=r.initialArgs,t!==b&&this.updateFromDelta(r,t)}}updateFromDelta(r,t){let o=dr(t,r.argTypes);this.argsByStoryId[r.id]=B(this.argsByStoryId[r.id],o)}updateFromPersisted(r,t){let o=cr(t,r.argTypes);return this.updateFromDelta(r,o)}update(r,t){if(!(r in this.argsByStoryId))throw new Error(`No args known for ${r} -- has it been rendered yet?`);this.argsByStoryId[r]=$r({...this.argsByStoryId[r],...t})}};import{logger as Vr}from\"@storybook/client-logger\";var k=(e={})=>Object.entries(e).reduce((r,[t,{defaultValue:o}])=>(typeof o<\"u\"&&(r[t]=o),r),{});var D=class{constructor({globals:r={},globalTypes:t={}}){this.set({globals:r,globalTypes:t})}set({globals:r={},globalTypes:t={}}){let o=this.initialGlobals&&_(this.initialGlobals,this.globals);this.allowedGlobalNames=new Set([...Object.keys(r),...Object.keys(t)]);let n=k(t);this.initialGlobals={...n,...r},this.globals=this.initialGlobals,o&&o!==b&&this.updateFromPersisted(o)}filterAllowedGlobals(r){return Object.entries(r).reduce((t,[o,n])=>(this.allowedGlobalNames.has(o)?t[o]=n:Vr.warn(`Attempted to set a global (${o}) that is not defined in initial globals or globalTypes`),t),{})}updateFromPersisted(r){let t=this.filterAllowedGlobals(r);this.globals={...this.globals,...t}}get(){return this.globals}update(r){this.globals={...this.globals,...this.filterAllowedGlobals(r)}}};import Lr from\"lodash/mapValues\";var vr=e=>typeof e==\"string\"?{name:e}:e,Wr=e=>typeof e==\"string\"?{type:e}:e,Hr=(e,r)=>{let{type:t,control:o,...n}=e,s={name:r,...n};return t&&(s.type=vr(t)),o?s.control=Wr(o):o===!1&&(s.control={disable:!0}),s},w=e=>Lr(e,Hr);import{storyNameFromExport as Ur,toId as Jr}from\"@storybook/csf\";import{dedent as Yr}from\"ts-dedent\";import{logger as qr}from\"@storybook/client-logger\";import Kr from\"util-deprecate\";var Qr=Yr`\nCSF .story annotations deprecated; annotate story functions directly:\n- StoryFn.story.name => StoryFn.storyName\n- StoryFn.story.(parameters|decorators) => StoryFn.(parameters|decorators)\nSee https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#hoisted-csf-annotations for details and codemod.\n`,Zr=Kr(()=>{},Qr);function M(e,r,t){let o=r,n=typeof r==\"function\"?r:null,{story:s}=o;s&&(qr.debug(\"deprecated story\",s),Zr());let i=Ur(e),a=typeof o!=\"function\"&&o.name||o.storyName||s?.name||i,l=[...o.decorators||[],...s?.decorators||[]],y={...s?.parameters,...o.parameters},d={...s?.args,...o.args},m={...s?.argTypes,...o.argTypes},f=[...o.loaders||[],...s?.loaders||[]],{render:u,play:j,tags:T=[]}=o,U=y.__id||Jr(t.id,i);return{moduleExport:r,id:U,name:a,tags:T,decorators:l,parameters:y,args:d,argTypes:w(m),loaders:f,...u&&{render:u},...n&&{userStoryFn:n},...j&&{play:j}}}import{isExportStory as re}from\"@storybook/csf\";import{logger as fr}from\"@storybook/client-logger\";import{sanitize as Xr}from\"@storybook/csf\";function $(e,r=e.title,t){let{id:o,argTypes:n}=e;return{id:Xr(o||r),...e,title:r,...n&&{argTypes:w(n)},parameters:{fileName:t,...e.parameters}}}var ee=e=>{let{globals:r,globalTypes:t}=e;(r||t)&&fr.error(\"Global args/argTypes can only be set globally\",JSON.stringify({globals:r,globalTypes:t}))},te=e=>{let{options:r}=e;r?.storySort&&fr.error(\"The storySort option parameter can only be set globally\")},Sr=e=>{!e||(ee(e),te(e))};function ur(e,r,t){let{default:o,__namedExportsOrder:n,...s}=e,i=$(o,t,r);Sr(i.parameters);let a={meta:i,stories:{}};return Object.keys(s).forEach(l=>{if(re(l,i)){let y=M(l,s[l],i);Sr(y.parameters),a.stories[y.id]=y}}),a}import{dedent as se}from\"ts-dedent\";import ie from\"util-deprecate\";import Fr from\"global\";import{includeConditionalArg as ae}from\"@storybook/csf\";import{applyHooks as le}from\"@storybook/addons\";import K from\"lodash/isPlainObject\";var F=(...e)=>{let r={},t=e.filter(Boolean),o=t.reduce((n,s)=>(Object.entries(s).forEach(([i,a])=>{let l=n[i];Array.isArray(a)||typeof l>\"u\"?n[i]=a:K(a)&&K(l)?r[i]=!0:typeof a<\"u\"&&(n[i]=a)}),n),{});return Object.keys(r).forEach(n=>{let s=t.filter(Boolean).map(i=>i[n]).filter(i=>typeof i<\"u\");s.every(i=>K(i))?o[n]=F(...s):o[n]=s[s.length-1]}),o};function oe(e,r,t){let o=t(e);return n=>r(o,n)}function ne({componentId:e,title:r,kind:t,id:o,name:n,story:s,parameters:i,initialArgs:a,argTypes:l,...y}={}){return y}function gr(e,r){let t={},o=s=>i=>{if(!t.value)throw new Error(\"Decorated function called without init\");return t.value={...t.value,...ne(i)},s(t.value)},n=r.reduce((s,i)=>oe(s,i,o),e);return s=>(t.value=s,n(s))}var ye=ie(()=>{},se`\n  \\`argType.defaultValue\\` is deprecated and will be removed in Storybook 7.0.\n\n  https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#no-longer-inferring-default-values-of-args`);function V(e,r,t){let{moduleExport:o,id:n,name:s}=e,{title:i}=r,a=[...e.tags||r.tags||[],\"story\"],l=F(t.parameters,r.parameters,e.parameters),y=[...e.decorators||[],...r.decorators||[],...t.decorators||[]],{applyDecorators:d=gr,argTypesEnhancers:m=[],argsEnhancers:f=[],runStep:u}=t,j=[...t.loaders||[],...r.loaders||[],...e.loaders||[]],T=e.userStoryFn||e.render||r.render||t.render;if(!T)throw new Error(`No render function available for storyId '${n}'`);let U=F(t.argTypes,r.argTypes,e.argTypes),{passArgsFirst:Er=!0}=l;l.__isArgsStory=Er&&T.length>0;let ar={...t.args,...r.args,...e.args},g={componentId:r.id,title:i,kind:i,id:n,name:s,story:s,component:r.component,subcomponents:r.subcomponents,tags:a,parameters:l,initialArgs:ar,argTypes:U};g.argTypes=m.reduce((c,S)=>S({...g,argTypes:c}),g.argTypes);let lr=k(g.argTypes);Object.keys(lr).length>0&&ye();let Or={...lr,...ar};g.initialArgs=f.reduce((c,S)=>({...c,...S({...g,initialArgs:c})}),Or),Fr.FEATURES?.breakingChangesV7||(g.parameters={...g.parameters,__id:n,globals:t.globals,globalTypes:t.globalTypes,args:g.initialArgs,argTypes:g.argTypes});let jr=async c=>{let S=await Promise.all(j.map(A=>A(c))),h=Object.assign({},...S);return{...c,loaded:h}},yr=c=>{let S=Object.entries(c.args).reduce((C,[P,I])=>{let E=c.argTypes[P]?.mapping;return C[P]=E&&I in E?E[I]:I,C},{}),h=Object.entries(S).reduce((C,[P,I])=>{let E=c.argTypes[P]||{};return ae(E,S,c.globals)&&(C[P]=I),C},{}),A={...c,args:h},{passArgsFirst:Br=!0}=c.parameters;return Br?T(A.args,A):T(A)},zr=le(d)(yr,y),Nr=c=>{let S=c;if(Fr.FEATURES?.argTypeTargetsV7){let h=q(c);S={...c,allArgs:c.args,argsByTarget:h,args:h[R]||{}}}return zr(S)},{play:mr}=e;return Object.freeze({...g,moduleExport:o,originalStoryFn:T,undecoratedStoryFn:yr,unboundStoryFn:Nr,applyLoaders:jr,playFunction:mr&&(async c=>{let S={...c,step:(h,A)=>u(h,A,S)};return mr(S)})})}import Q from\"lodash/mapValues\";import{dedent as me}from\"ts-dedent\";import{logger as pe}from\"@storybook/client-logger\";var Z=(e,r,t)=>{let o=typeof e;switch(o){case\"boolean\":case\"string\":case\"number\":case\"function\":case\"symbol\":return{name:o};default:break}if(e){if(t.has(e))return pe.warn(me`\n        We've detected a cycle in arg '${r}'. Args should be JSON-serializable.\n\n        Consider using the mapping feature or fully custom args:\n        - Mapping: https://storybook.js.org/docs/react/writing-stories/args#mapping-to-complex-arg-values\n        - Custom args: https://storybook.js.org/docs/react/essentials/controls#fully-custom-args\n      `),{name:\"other\",value:\"cyclic object\"};if(t.add(e),Array.isArray(e)){let s=e.length>0?Z(e[0],r,new Set(t)):{name:\"other\",value:\"unknown\"};return{name:\"array\",value:s}}let n=Q(e,s=>Z(s,r,new Set(t)));return{name:\"object\",value:n}}return{name:\"object\",value:{}}},X=e=>{let{id:r,argTypes:t={},initialArgs:o={}}=e,n=Q(o,(i,a)=>({name:a,type:Z(i,`${r}.${a}`,new Set)})),s=Q(t,(i,a)=>({name:a}));return F(n,s,t)};X.secondPass=!0;import de from\"lodash/mapValues\";import{logger as Se}from\"@storybook/client-logger\";import ce from\"lodash/pickBy\";var hr=(e,r)=>Array.isArray(r)?r.includes(e):e.match(r),rr=(e,r,t)=>!r&&!t?e:e&&ce(e,(o,n)=>{let s=o.name||n;return(!r||hr(s,r))&&(!t||!hr(s,t))});var fe=(e,r,t)=>{let{type:o,options:n}=e;if(!!o){if(t.color&&t.color.test(r)){let s=o.name;if(s===\"string\")return{control:{type:\"color\"}};s!==\"enum\"&&Se.warn(`Addon controls: Control of type color only supports string, received \"${s}\" instead`)}if(t.date&&t.date.test(r))return{control:{type:\"date\"}};switch(o.name){case\"array\":return{control:{type:\"object\"}};case\"boolean\":return{control:{type:\"boolean\"}};case\"string\":return{control:{type:\"text\"}};case\"number\":return{control:{type:\"number\"}};case\"enum\":{let{value:s}=o;return{control:{type:s?.length<=5?\"radio\":\"select\"},options:s}}case\"function\":case\"symbol\":return null;default:return{control:{type:n?\"select\":\"object\"}}}}},L=e=>{let{argTypes:r,parameters:{__isArgsStory:t,controls:{include:o=null,exclude:n=null,matchers:s={}}={}}}=e;if(!t)return r;let i=rr(r,o,n),a=de(i,(l,y)=>l?.type&&fe(l,y,s));return F(a,i)};L.secondPass=!0;function v({argTypes:e,globalTypes:r,argTypesEnhancers:t,...o}){return{...e&&{argTypes:w(e)},...r&&{globalTypes:w(r)},argTypesEnhancers:[...t||[],X,L],...o}}function Tr(e){return async(r,t,o)=>{await e.reduceRight((s,i)=>async()=>i(r,s,o),async()=>t(o))()}}function O(e,r){return e.map(t=>t[r]).filter(Boolean)}function W(e,r){return O(e,r).reduce((t,o)=>[...t,...o],[])}function H(e,r){return Object.assign({},...O(e,r))}function er(e,r){return O(e,r).pop()}function Ar(e){let r=W(e,\"argTypesEnhancers\"),t=O(e,\"runStep\");return{parameters:F(...O(e,\"parameters\")),decorators:W(e,\"decorators\"),args:H(e,\"args\"),argsEnhancers:W(e,\"argsEnhancers\"),argTypes:H(e,\"argTypes\"),argTypesEnhancers:[...r.filter(o=>!o.secondPass),...r.filter(o=>o.secondPass)],globals:H(e,\"globals\"),globalTypes:H(e,\"globalTypes\"),loaders:W(e,\"loaders\"),render:er(e,\"render\"),renderToDOM:er(e,\"renderToDOM\"),applyDecorators:er(e,\"applyDecorators\"),runStep:Tr(t)}}import{isExportStory as ue}from\"@storybook/csf\";import{HooksContext as ge}from\"@storybook/addons\";var br={};function eo(e){let r=Array.isArray(e)?e:[e];br=Ar(r)}function to(e,r,t=br,o={},n){if(e===void 0)throw new Error(\"Expected a story but received undefined.\");r.title=r.title??\"ComposedStory\";let s=$(r),i=n||e.storyName||e.story?.name||e.name||\"unknown\",a=M(i,e,s),l=v({...t,...o}),y=V(a,s,l),d=k(t.globalTypes),m=f=>{let u={...y,hooks:new ge,globals:d,args:{...y.initialArgs,...f}};return y.unboundStoryFn(u)};return m.storyName=i,m.args=y.initialArgs,m.play=y.playFunction,m.parameters=y.parameters,m}function oo(e,r,t){let{default:o,__esModule:n,__namedExportsOrder:s,...i}=e;return Object.entries(i).reduce((l,[y,d])=>ue(y,o)?Object.assign(l,{[y]:t(d,o,r,y)}):l,{})}var Te=1e3,Ae=1e4,or=class{constructor(){this.getStoriesJsonData=()=>{let{storyIndex:r}=this;if(!r)throw new Error(\"getStoriesJsonData called before initialization\");let t=this.getSetStoriesPayload(),o=[\"fileName\",\"docsOnly\",\"framework\",\"__id\",\"__isArgsStory\"],n=Fe(t.stories,s=>{let{importPath:i}=r.entries[s.id];return{...xr(s,[\"id\",\"name\",\"title\"]),importPath:i,kind:s.title,story:s.name,parameters:{...xr(s.parameters,o),fileName:i}}});return{v:3,stories:n}};this.args=new G,this.hooks={},this.processCSFFileWithCache=wr(Te)(ur),this.prepareStoryWithCache=wr(Ae)(V),this.initializationPromise=new tr(r=>{this.resolveInitializationPromise=r})}setProjectAnnotations(r){this.projectAnnotations=v(r);let{globals:t,globalTypes:o}=r;this.globals?this.globals.set({globals:t,globalTypes:o}):this.globals=new D({globals:t,globalTypes:o})}initialize({storyIndex:r,importFn:t,cache:o=!1}){return this.storyIndex=new z(r),this.importFn=t,this.resolveInitializationPromise(),o?this.cacheAllCSFFiles():tr.resolve()}async onStoriesChanged({importFn:r,storyIndex:t}){await this.initializationPromise,r&&(this.importFn=r),t&&(this.storyIndex.entries=t.entries),this.cachedCSFFiles&&await this.cacheAllCSFFiles()}async storyIdToEntry(r){return await this.initializationPromise,this.storyIndex.storyIdToEntry(r)}loadCSFFileByStoryId(r){if(!this.storyIndex||!this.importFn)throw new Error(\"loadCSFFileByStoryId called before initialization\");let{importPath:t,title:o}=this.storyIndex.storyIdToEntry(r);return this.importFn(t).then(n=>this.processCSFFileWithCache(n,t,o))}loadAllCSFFiles(){if(!this.storyIndex)throw new Error(\"loadAllCSFFiles called before initialization\");let r={};Object.entries(this.storyIndex.entries).forEach(([o,{importPath:n}])=>{r[n]=o});let t=Object.entries(r).map(([o,n])=>this.loadCSFFileByStoryId(n).then(s=>({importPath:o,csfFile:s})));return tr.all(t).then(o=>o.reduce((n,{importPath:s,csfFile:i})=>(n[s]=i,n),{}))}cacheAllCSFFiles(){return this.initializationPromise.then(()=>this.loadAllCSFFiles().then(r=>{this.cachedCSFFiles=r}))}async loadStory({storyId:r}){await this.initializationPromise;let t=await this.loadCSFFileByStoryId(r);return this.storyFromCSFFile({storyId:r,csfFile:t})}storyFromCSFFile({storyId:r,csfFile:t}){if(!this.projectAnnotations)throw new Error(\"storyFromCSFFile called before initialization\");let o=t.stories[r];if(!o)throw new Error(`Didn't find '${r}' in CSF file, this is unexpected`);let n=t.meta,s=this.prepareStoryWithCache(o,n,this.projectAnnotations);return this.args.setInitial(s),this.hooks[s.id]=this.hooks[s.id]||new he,s}componentStoriesFromCSFFile({csfFile:r}){if(!this.storyIndex)throw new Error(\"componentStoriesFromCSFFile called before initialization\");return Object.keys(this.storyIndex.entries).filter(t=>!!r.stories[t]).map(t=>this.storyFromCSFFile({storyId:t,csfFile:r}))}async loadEntry(r){let t=await this.storyIdToEntry(r),{importFn:o,storyIndex:n}=this;if(!n||!o)throw new Error(\"loadEntry called before initialization\");let s=t.type===\"docs\"?t.storiesImports:[],[i,...a]=await Promise.all([o(t.importPath),...s.map(l=>{let y=n.importPathToEntry(l);return this.loadCSFFileByStoryId(y.id)})]);return{entryExports:i,csfFiles:a}}getStoryContext(r){if(!this.globals)throw new Error(\"getStoryContext called before initialization\");return{...r,args:this.args.get(r.id),globals:this.globals.get(),hooks:this.hooks[r.id]}}cleanupStory(r){this.hooks[r.id].clean()}extract(r={includeDocsOnly:!1}){if(!this.storyIndex)throw new Error(\"extract called before initialization\");let{cachedCSFFiles:t}=this;if(!t)throw new Error(\"Cannot call extract() unless you call cacheAllCSFFiles() first.\");return Object.entries(this.storyIndex.entries).reduce((o,[n,{type:s,importPath:i}])=>{if(s===\"docs\")return o;let a=t[i],l=this.storyFromCSFFile({storyId:n,csfFile:a});return!r.includeDocsOnly&&l.parameters.docsOnly||(o[n]=Object.entries(l).reduce((y,[d,m])=>d===\"moduleExport\"||typeof m==\"function\"?y:Array.isArray(m)?Object.assign(y,{[d]:m.slice().sort()}):Object.assign(y,{[d]:m}),{args:l.initialArgs})),o},{})}getSetStoriesPayload(){if(!this.globals)throw new Error(\"getSetStoriesPayload called before initialization\");let r=this.extract({includeDocsOnly:!0}),t=Object.values(r).reduce((o,{title:n})=>(o[n]={},o),{});return{v:2,globals:this.globals.get(),globalParameters:{},kindParameters:t,stories:r}}getSetIndexPayload(){if(!this.storyIndex)throw new Error(\"getSetIndexPayload called before initialization\");let r=this.extract({includeDocsOnly:!0});return{v:4,entries:Object.fromEntries(Object.entries(this.storyIndex.entries).map(([t,o])=>[t,r[t]?{...o,args:r[t].initialArgs,initialArgs:r[t].initialArgs,argTypes:r[t].argTypes,parameters:r[t].parameters}:o]))}}raw(){return Object.values(this.extract()).map(({id:r})=>this.fromId(r)).filter(Boolean)}fromId(r){if(!this.storyIndex)throw new Error(\"fromId called before initialization\");if(!this.cachedCSFFiles)throw new Error(\"Cannot call fromId/raw() unless you call cacheAllCSFFiles() first.\");let t;try{({importPath:t}=this.storyIndex.storyIdToEntry(r))}catch{return null}let o=this.cachedCSFFiles[t],n=this.storyFromCSFFile({storyId:r,csfFile:o});return{...n,storyFn:s=>{let i={...this.getStoryContext(n),viewMode:\"story\"};return n.unboundStoryFn({...i,...s})}}}};import{SHARED_STATE_CHANGED as nr,SHARED_STATE_SET as sr}from\"@storybook/core-events\";import{addons as be,HooksContext as Fo,applyHooks as ho,useMemo as we,useCallback as To,useRef as Ao,useState as xe,useReducer as bo,useEffect as _e,useChannel as ke,useStoryContext as wo,useParameter as xo,useArgs as _o,useGlobals as ko}from\"@storybook/addons\";function Ce(e,r){let t=be.getChannel(),[o]=t.last(`${nr}-manager-${e}`)||t.last(`${sr}-manager-${e}`)||[],[n,s]=xe(o||r),i=we(()=>({[`${nr}-manager-${e}`]:l=>s(l),[`${sr}-manager-${e}`]:l=>s(l)}),[e]),a=ke(i,[e]);return _e(()=>{r!==void 0&&!o&&a(`${sr}-client-${e}`,r)},[e]),[n,l=>{s(l),a(`${nr}-client-${e}`,l)}]}function Co(e,r){return Ce(e,r)}import ir from\"slash\";import{dedent as Pe}from\"ts-dedent\";import{once as Ie}from\"@storybook/client-logger\";var Ee=e=>{let r=[...e],t=r[r.length-1],o=t.indexOf(\".\"),n=o>0?t.substr(0,o):t;r[r.length-1]=n;let[s,...i]=r;return s===\"\"&&(r=i),r},Oe=/^index$/i,je=e=>{let r;return e.filter((t,o)=>o===e.length-1&&(t===r||Oe.test(t))?!1:(r=t,!0))};function _r(e){let r=new RegExp(\"/{1,}\",\"g\");return e.join(\"/\").replace(r,\"/\")}var ze=(e,r,t)=>{let{directory:o,importPathMatcher:n,titlePrefix:s=\"\"}=r||{};typeof e==\"number\"&&Ie.warn(Pe`\n      CSF Auto-title received a numeric fileName. This typically happens when\n      webpack is mis-configured in production mode. To force webpack to produce\n      filenames, set optimization.moduleIds = \"named\" in your webpack config.\n    `);let i=ir(String(e));if(n.exec(i)){if(!t){let a=i.replace(o,\"\"),y=ir(_r([s,a])).split(\"/\");return y=Ee(y),y=je(y),y.join(\"/\")}return s?ir(_r([s,t])):t}},jo=(e,r,t)=>{for(let o=0;o<r.length;o+=1){let n=ze(e,r[o],t);if(n)return n}return t||void 0};import{dedent as Ne}from\"ts-dedent\";var kr=/\\s*\\/\\s*/,Cr=(e={})=>(r,t)=>{if(r.title===t.title&&!e.includeNames)return 0;let o=e.method||\"configure\",n=e.order||[],s=r.title.trim().split(kr),i=t.title.trim().split(kr);e.includeNames&&(s.push(r.name),i.push(t.name));let a=0;for(;s[a]||i[a];){if(!s[a])return-1;if(!i[a])return 1;let l=s[a],y=i[a];if(l!==y){let m=n.indexOf(l),f=n.indexOf(y),u=n.indexOf(\"*\");return m!==-1||f!==-1?(m===-1&&(u!==-1?m=u:m=n.length),f===-1&&(u!==-1?f=u:f=n.length),m-f):o===\"configure\"?0:l.localeCompare(y,e.locales?e.locales:void 0,{numeric:!0,sensitivity:\"accent\"})}let d=n.indexOf(l);d===-1&&(d=n.indexOf(\"*\")),n=d!==-1&&Array.isArray(n[d+1])?n[d+1]:[],a+=1}return 0};var Ir=(e,r,t)=>{if(r){let o;typeof r==\"function\"?o=r:o=Cr(r),e.sort(o)}else e.sort((o,n)=>t.indexOf(o.importPath)-t.indexOf(n.importPath));return e},Go=(e,r,t)=>{try{return Ir(e,r,t)}catch(o){throw new Error(Ne`\n    Error sorting stories with sort parameter ${r}:\n\n    > ${o.message}\n    \n    Are you using a V6-style sort function in V7 mode?\n\n    More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#v7-style-story-sort\n  `)}},Pr=e=>{let{id:r,title:t,name:o,parameters:n,type:s}=e;return{id:r,title:t,name:o,importPath:n.fileName,type:s}},Do=(e,r,t)=>{if(r&&typeof r==\"function\")return e.sort(r),e.map(n=>Pr(n[1]));let o=e.map(n=>Pr(n[1]));return Ir(o,r,t)};export{b as DEEPLY_EQUAL,Fo as HooksContext,R as NO_TARGET_NAME,or as StoryStore,ho as applyHooks,B as combineArgs,F as combineParameters,Ar as composeConfigs,Tr as composeStepRunners,oo as composeStories,to as composeStory,oe as decorateStory,_ as deepDiff,gr as defaultDecorateStory,rr as filterArgTypes,W as getArrayField,O as getField,H as getObjectField,er as getSingletonField,k as getValuesFromArgTypes,q as groupArgsByTarget,L as inferControls,cr as mapArgsToTypes,ve as noTargetArgs,$ as normalizeComponentAnnotations,Hr as normalizeInputType,w as normalizeInputTypes,v as normalizeProjectAnnotations,M as normalizeStory,V as prepareStory,ur as processCSFFile,ne as sanitizeStoryContextUpdate,eo as setProjectAnnotations,Do as sortStoriesV6,Go as sortStoriesV7,Co as useAddonState,_o as useArgs,To as useCallback,ke as useChannel,_e as useEffect,ko as useGlobals,we as useMemo,xo as useParameter,bo as useReducer,Ao as useRef,Ce as useSharedState,xe as useState,wo as useStoryContext,jo as userOrAutoTitle,ze as userOrAutoTitleFromSpecifier,dr as validateOptions};\n"],"names":[],"sourceRoot":""}